{
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "forgot-password",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        0,
        176
      ],
      "id": "forgot-password-webhook-001",
      "name": "Webhook - Forgot Password",
      "webhookId": "forgot-password-temp-pwd-001"
    },
    {
      "parameters": {
        "jsCode": "// ‚úÖ N8N Code Node - Email Qu√™n M·∫≠t Kh·∫©u (Temporary Password)\n\n// B∆Ø·ªöC 1: L·∫•y d·ªØ li·ªáu t·ª´ input\nconst body = $json.body || $json;\n\nconst email = body.email || \"unknown@email.com\";\nconst username = body.username || \"Guest\";\nconst temp_password = body.temp_password || \"********\";\nconst timestamp = body.timestamp || new Date().toISOString();\nconst login_url = body.login_url || \"http://127.0.0.1:5000/login\";\nconst expires_in_minutes = body.expires_in_minutes || 2;\n\n// B∆Ø·ªöC 2: Format timestamp\nconst formattedDate = new Date(timestamp).toLocaleString('vi-VN', {\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit',\n  hour: '2-digit',\n  minute: '2-digit',\n  second: '2-digit',\n  hour12: false\n});\n\n// B∆Ø·ªöC 3: T√≠nh th·ªùi gian h·∫øt h·∫°n\nconst expiresAt = new Date(new Date(timestamp).getTime() + expires_in_minutes * 60000);\nconst formattedExpiresAt = expiresAt.toLocaleString('vi-VN', {\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit',\n  hour: '2-digit',\n  minute: '2-digit',\n  second: '2-digit',\n  hour12: false\n});\n\n// B∆Ø·ªöC 4: T·∫°o greeting d·ª±a tr√™n th·ªùi gian\nconst hour = new Date(timestamp).getHours();\nlet greeting = '';\nlet greetingIcon = '';\nif (hour >= 5 && hour < 12) {\n  greeting = 'Ch√†o bu·ªïi s√°ng';\n  greetingIcon = 'üåÖ';\n} else if (hour >= 12 && hour < 18) {\n  greeting = 'Ch√†o bu·ªïi chi·ªÅu';\n  greetingIcon = '‚òÄÔ∏è';\n} else if (hour >= 18 && hour < 22) {\n  greeting = 'Ch√†o bu·ªïi t·ªëi';\n  greetingIcon = 'üåÜ';\n} else {\n  greeting = 'Ch√†o b·∫°n';\n  greetingIcon = 'üåô';\n}\n\n// B∆Ø·ªöC 5: T·∫°o HTML email ƒë·∫πp cho Forgot Password\nconst htmlBody = `<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 50%, #FFB84D 100%);\n            padding: 40px 20px;\n            min-height: 100vh;\n        }\n        .email-wrapper {\n            max-width: 680px;\n            margin: 0 auto;\n        }\n        .container {\n            background: white;\n            border-radius: 30px;\n            box-shadow: 0 30px 90px rgba(0,0,0,0.35);\n            overflow: hidden;\n            animation: slideIn 0.8s ease-out;\n        }\n        @keyframes slideIn {\n            from { opacity: 0; transform: translateY(-50px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        .header {\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 50%, #FFB84D 100%);\n            color: white;\n            padding: 60px 40px;\n            text-align: center;\n            position: relative;\n            overflow: hidden;\n        }\n        .warning-badge {\n            width: 150px;\n            height: 150px;\n            margin: 0 auto 30px;\n            background: linear-gradient(135deg, #FFD93D 0%, #FFA500 50%, #FFD93D 100%);\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            border: 6px solid rgba(255,255,255,0.5);\n            font-size: 80px;\n            box-shadow: 0 15px 40px rgba(255,165,0,0.5);\n        }\n        .header h1 {\n            font-size: 42px;\n            font-weight: 900;\n            margin: 0 0 20px 0;\n            text-shadow: 0 4px 20px rgba(0,0,0,0.3);\n        }\n        .header-subtitle {\n            font-size: 20px;\n            font-weight: 600;\n            opacity: 0.95;\n            line-height: 1.6;\n        }\n        .content {\n            padding: 60px 50px;\n        }\n        .greeting-section {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            border-radius: 25px;\n            padding: 50px 40px;\n            margin: 50px 0;\n            color: white;\n            box-shadow: 0 15px 45px rgba(102, 126, 234, 0.5);\n            text-align: center;\n        }\n        .greeting-emoji {\n            font-size: 60px;\n            margin-bottom: 20px;\n            display: block;\n        }\n        .greeting-text {\n            font-size: 26px;\n            font-weight: 700;\n            margin-bottom: 15px;\n        }\n        .greeting-name {\n            font-size: 38px;\n            font-weight: 900;\n            margin: 15px 0 20px 0;\n            letter-spacing: 1px;\n        }\n        .warning-card {\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);\n            border-radius: 25px;\n            padding: 55px 45px;\n            margin: 60px 0;\n            box-shadow: 0 20px 60px rgba(255, 107, 107, 0.5);\n            text-align: center;\n        }\n        .warning-icon {\n            font-size: 70px;\n            margin-bottom: 25px;\n        }\n        .warning-title {\n            color: white;\n            font-size: 32px;\n            font-weight: 900;\n            margin-bottom: 20px;\n            text-shadow: 0 3px 15px rgba(0,0,0,0.3);\n        }\n        .warning-text {\n            color: rgba(255,255,255,0.95);\n            font-size: 18px;\n            line-height: 1.9;\n            text-shadow: 0 1px 5px rgba(0,0,0,0.2);\n        }\n        .temp-password-card {\n            background: linear-gradient(135deg, #F0F8FF 0%, #E0F8FF 100%);\n            border-radius: 25px;\n            padding: 50px 45px;\n            margin: 60px 0;\n            border-left: 8px solid #FF6B6B;\n            box-shadow: 0 10px 35px rgba(255, 107, 107, 0.3);\n        }\n        .temp-pwd-title {\n            color: #FF6B6B;\n            font-size: 28px;\n            font-weight: 900;\n            margin-bottom: 12px;\n            text-align: center;\n        }\n        .temp-pwd-subtitle {\n            color: #FF8E53;\n            font-size: 16px;\n            font-weight: 600;\n            text-align: center;\n            margin-bottom: 35px;\n        }\n        .password-display {\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);\n            border-radius: 18px;\n            padding: 35px;\n            margin: 30px 0;\n            text-align: center;\n            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);\n        }\n        .password-label {\n            color: rgba(255,255,255,0.9);\n            font-size: 14px;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 2px;\n            margin-bottom: 15px;\n        }\n        .password-value {\n            background: white;\n            color: #FF6B6B;\n            font-size: 42px;\n            font-weight: 900;\n            padding: 25px 40px;\n            border-radius: 15px;\n            letter-spacing: 8px;\n            font-family: 'Courier New', monospace;\n            box-shadow: 0 5px 20px rgba(0,0,0,0.2);\n            border: 4px solid #FFD93D;\n        }\n        .info-grid {\n            display: grid;\n            gap: 18px;\n            margin-top: 30px;\n        }\n        .info-item {\n            background: white;\n            border-radius: 18px;\n            padding: 25px;\n            display: flex;\n            align-items: center;\n            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.15);\n            border: 2px solid transparent;\n        }\n        .info-icon-box {\n            width: 65px;\n            height: 65px;\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);\n            border-radius: 16px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 32px;\n            margin-right: 22px;\n            flex-shrink: 0;\n            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);\n        }\n        .info-content {\n            flex: 1;\n        }\n        .info-label {\n            color: #FF8E53;\n            font-size: 13px;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 1.5px;\n            margin-bottom: 8px;\n        }\n        .info-value {\n            color: #1E3A8A;\n            font-size: 19px;\n            font-weight: 800;\n            word-break: break-all;\n        }\n        .instructions-section {\n            margin: 70px 0;\n            background: rgba(240, 248, 255, 0.5);\n            padding: 60px 40px;\n            border-radius: 20px;\n        }\n        .section-title {\n            color: #FF6B6B;\n            font-size: 34px;\n            font-weight: 900;\n            margin-bottom: 15px;\n            text-align: center;\n        }\n        .section-subtitle {\n            color: #64748b;\n            font-size: 17px;\n            margin-top: 20px;\n            font-weight: 500;\n            text-align: center;\n            margin-bottom: 40px;\n        }\n        .steps-grid {\n            display: grid;\n            gap: 25px;\n        }\n        .step-card {\n            background: white;\n            border-radius: 20px;\n            padding: 30px;\n            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.15);\n            display: flex;\n            align-items: flex-start;\n            border-left: 6px solid;\n        }\n        .step-card-1 { border-left-color: #FF6B6B; }\n        .step-card-2 { border-left-color: #FF8E53; }\n        .step-card-3 { border-left-color: #FFB84D; }\n        .step-card-4 { border-left-color: #667eea; }\n        .step-number {\n            width: 60px;\n            height: 60px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 28px;\n            font-weight: 900;\n            color: white;\n            margin-right: 25px;\n            flex-shrink: 0;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n        }\n        .step-card-1 .step-number { background: linear-gradient(135deg, #FF6B6B, #FF8E53); }\n        .step-card-2 .step-number { background: linear-gradient(135deg, #FF8E53, #FFB84D); }\n        .step-card-3 .step-number { background: linear-gradient(135deg, #FFB84D, #FFD93D); }\n        .step-card-4 .step-number { background: linear-gradient(135deg, #667eea, #764ba2); }\n        .step-content {\n            flex: 1;\n        }\n        .step-title {\n            color: #1E3A8A;\n            font-size: 22px;\n            font-weight: 800;\n            margin-bottom: 12px;\n        }\n        .step-desc {\n            color: #64748b;\n            font-size: 16px;\n            line-height: 1.7;\n        }\n        .security-alert {\n            background: linear-gradient(135deg, #FFD93D 0%, #FFA500 100%);\n            border-radius: 25px;\n            padding: 40px;\n            margin: 50px 0;\n            text-align: center;\n            box-shadow: 0 15px 45px rgba(255, 165, 0, 0.4);\n        }\n        .alert-icon {\n            font-size: 60px;\n            margin-bottom: 20px;\n        }\n        .alert-title {\n            color: white;\n            font-size: 28px;\n            font-weight: 900;\n            margin-bottom: 15px;\n            text-shadow: 0 2px 10px rgba(0,0,0,0.2);\n        }\n        .alert-text {\n            color: rgba(255,255,255,0.95);\n            font-size: 17px;\n            line-height: 1.8;\n        }\n        .cta-section {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            border-radius: 25px;\n            padding: 60px 45px;\n            margin: 70px 0;\n            text-align: center;\n            border: 4px solid #667eea;\n            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.4);\n        }\n        .cta-icon {\n            font-size: 80px;\n            margin-bottom: 25px;\n        }\n        .cta-title {\n            color: white;\n            font-size: 32px;\n            font-weight: 900;\n            margin-bottom: 20px;\n        }\n        .cta-text {\n            color: rgba(255,255,255,0.95);\n            font-size: 18px;\n            line-height: 1.9;\n            margin-bottom: 30px;\n            font-weight: 600;\n        }\n        .cta-button {\n            display: inline-block;\n            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);\n            color: white;\n            text-decoration: none;\n            padding: 22px 60px;\n            border-radius: 60px;\n            font-weight: 900;\n            font-size: 20px;\n            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.5);\n            border: 3px solid white;\n        }\n        .divider {\n            height: 4px;\n            background: linear-gradient(to right, transparent, #FF8E53, transparent);\n            margin: 50px 0;\n        }\n        .footer {\n            background: linear-gradient(135deg, #F0F8FF 0%, #E0F8FF 100%);\n            padding: 50px 40px;\n            text-align: center;\n            border-top: 4px solid #FF6B6B;\n        }\n        .footer-logo {\n            font-size: 60px;\n            margin-bottom: 20px;\n            display: block;\n        }\n        .footer-brand {\n            color: #FF6B6B;\n            font-size: 24px;\n            font-weight: 900;\n            margin-bottom: 12px;\n        }\n        .footer-tagline {\n            color: #FF8E53;\n            font-size: 16px;\n            font-weight: 600;\n            margin-bottom: 25px;\n        }\n        .footer-info {\n            color: #1E3A8A;\n            font-size: 15px;\n            line-height: 2;\n            margin-bottom: 25px;\n        }\n        .footer-time {\n            background: white;\n            border-radius: 15px;\n            padding: 18px 32px;\n            display: inline-block;\n            color: #FF6B6B;\n            font-size: 15px;\n            font-weight: 800;\n            margin: 20px 0;\n            box-shadow: 0 4px 18px rgba(255, 107, 107, 0.2);\n            border: 2px solid #FFB6C1;\n        }\n        .footer-copyright {\n            color: #1E3A8A;\n            font-size: 14px;\n            margin-top: 30px;\n            padding-top: 30px;\n            border-top: 2px solid #FFB6C1;\n            line-height: 1.8;\n        }\n        @media only screen and (max-width: 600px) {\n            .content { padding: 35px 25px; }\n            .header h1 { font-size: 30px; }\n            .password-value { font-size: 32px; letter-spacing: 4px; }\n            .cta-button { padding: 18px 40px; font-size: 18px; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-wrapper\">\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"warning-badge\">üîê</div>\n                <h1>Y√äU C·∫¶U ƒê·∫∂T L·∫†I M·∫¨T KH·∫®U</h1>\n                <p class=\"header-subtitle\">Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu kh√¥i ph·ª•c m·∫≠t kh·∫©u c·ªßa b·∫°n<br/>M·∫≠t kh·∫©u t·∫°m th·ªùi c√≥ hi·ªáu l·ª±c trong ${expires_in_minutes} ph√∫t</p>\n            </div>\n\n            <div class=\"content\">\n                <div class=\"greeting-section\">\n                    <span class=\"greeting-emoji\">${greetingIcon}</span>\n                    <div class=\"greeting-text\">${greeting}!</div>\n                    <div class=\"greeting-name\">${username}</div>\n                </div>\n\n                <div class=\"warning-card\">\n                    <div class=\"warning-icon\">‚ö†Ô∏è</div>\n                    <div class=\"warning-title\">Th√¥ng B√°o B·∫£o M·∫≠t</div>\n                    <div class=\"warning-text\">\n                        N·∫øu b·∫°n KH√îNG y√™u c·∫ßu ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u, vui l√≤ng B·ªé QUA email n√†y<br/>\n                        v√† li√™n h·ªá ngay v·ªõi b·ªô ph·∫≠n h·ªó tr·ª£ ƒë·ªÉ b·∫£o v·ªá t√†i kho·∫£n!\n                    </div>\n                </div>\n\n                <div class=\"temp-password-card\">\n                    <div class=\"temp-pwd-title\">üîë M·∫≠t Kh·∫©u T·∫°m Th·ªùi</div>\n                    <div class=\"temp-pwd-subtitle\">S·ª≠ d·ª•ng m·∫≠t kh·∫©u n√†y ƒë·ªÉ ƒëƒÉng nh·∫≠p v√† ƒë·ªïi m·∫≠t kh·∫©u m·ªõi</div>\n                    \n                    <div class=\"password-display\">\n                        <div class=\"password-label\">‚è±Ô∏è M·∫≠t kh·∫©u t·∫°m (C√≥ hi·ªáu l·ª±c ${expires_in_minutes} ph√∫t)</div>\n                        <div class=\"password-value\">${temp_password}</div>\n                    </div>\n\n                    <div class=\"info-grid\">\n                        <div class=\"info-item\">\n                            <div class=\"info-icon-box\">üìß</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">Email</div>\n                                <div class=\"info-value\">${email}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon-box\">üë§</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">Username</div>\n                                <div class=\"info-value\">${username}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon-box\">üìÖ</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">Th·ªùi Gian T·∫°o</div>\n                                <div class=\"info-value\">${formattedDate}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon-box\">‚è∞</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">H·∫øt H·∫°n L√∫c</div>\n                                <div class=\"info-value\">${formattedExpiresAt}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"instructions-section\">\n                    <div class=\"section-title\">üìã H∆∞·ªõng D·∫´n ƒê·ªïi M·∫≠t Kh·∫©u</div>\n                    <div class=\"section-subtitle\">L√†m theo 4 b∆∞·ªõc ƒë∆°n gi·∫£n ƒë·ªÉ kh√¥i ph·ª•c t√†i kho·∫£n</div>\n                    \n                    <div class=\"steps-grid\">\n                        <div class=\"step-card step-card-1\">\n                            <div class=\"step-number\">1</div>\n                            <div class=\"step-content\">\n                                <div class=\"step-title\">Truy c·∫≠p trang ƒëƒÉng nh·∫≠p</div>\n                                <div class=\"step-desc\">M·ªü tr√¨nh duy·ªát v√† truy c·∫≠p v√†o trang ƒëƒÉng nh·∫≠p c·ªßa File Transfer System</div>\n                            </div>\n                        </div>\n                        <div class=\"step-card step-card-2\">\n                            <div class=\"step-number\">2</div>\n                            <div class=\"step-content\">\n                                <div class=\"step-title\">Nh·∫≠p m·∫≠t kh·∫©u t·∫°m</div>\n                                <div class=\"step-desc\">S·ª≠ d·ª•ng m·∫≠t kh·∫©u t·∫°m th·ªùi <strong>${temp_password}</strong> ƒë·ªÉ ƒëƒÉng nh·∫≠p (c√≥ hi·ªáu l·ª±c ${expires_in_minutes} ph√∫t)</div>\n                            </div>\n                        </div>\n                        <div class=\"step-card step-card-3\">\n                            <div class=\"step-number\">3</div>\n                            <div class=\"step-content\">\n                                <div class=\"step-title\">ƒê·ªïi m·∫≠t kh·∫©u m·ªõi</div>\n                                <div class=\"step-desc\">H·ªá th·ªëng s·∫Ω y√™u c·∫ßu b·∫°n ƒë·ªïi m·∫≠t kh·∫©u m·ªõi ngay sau khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng</div>\n                            </div>\n                        </div>\n                        <div class=\"step-card step-card-4\">\n                            <div class=\"step-number\">4</div>\n                            <div class=\"step-content\">\n                                <div class=\"step-title\">Ho√†n t·∫•t v√† s·ª≠ d·ª•ng</div>\n                                <div class=\"step-desc\">Sau khi ƒë·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng m·∫≠t kh·∫©u m·ªõi ƒë·ªÉ ƒëƒÉng nh·∫≠p l·∫ßn sau</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"security-alert\">\n                    <span class=\"alert-icon\">üõ°Ô∏è</span>\n                    <div class=\"alert-title\">L∆∞u √ù B·∫£o M·∫≠t Quan Tr·ªçng</div>\n                    <div class=\"alert-text\">\n                        ‚úì M·∫≠t kh·∫©u t·∫°m ch·ªâ c√≥ hi·ªáu l·ª±c trong ${expires_in_minutes} ph√∫t<br/>\n                        ‚úì B·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p b·∫±ng m·∫≠t kh·∫©u C≈® ho·∫∑c m·∫≠t kh·∫©u T·∫†M<br/>\n                        ‚úì Sau khi ƒëƒÉng nh·∫≠p b·∫±ng m·∫≠t kh·∫©u t·∫°m, B·∫ÆT BU·ªòC ph·∫£i ƒë·ªïi m·∫≠t kh·∫©u m·ªõi<br/>\n                        ‚úì KH√îNG chia s·∫ª m·∫≠t kh·∫©u t·∫°m cho b·∫•t k·ª≥ ai<br/>\n                        ‚úì N·∫øu kh√¥ng ph·∫£i b·∫°n y√™u c·∫ßu, h√£y li√™n h·ªá h·ªó tr·ª£ NGAY L·∫¨P T·ª®C\n                    </div>\n                </div>\n\n                <div class=\"cta-section\">\n                    <span class=\"cta-icon\">üöÄ</span>\n                    <div class=\"cta-title\">ƒêƒÉng Nh·∫≠p Ngay B√¢y Gi·ªù</div>\n                    <div class=\"cta-text\">\n                        Nh·∫•p v√†o n√∫t b√™n d∆∞·ªõi ƒë·ªÉ truy c·∫≠p trang ƒëƒÉng nh·∫≠p<br/>\n                        v√† s·ª≠ d·ª•ng m·∫≠t kh·∫©u t·∫°m ƒë·ªÉ ƒë·ªïi m·∫≠t kh·∫©u m·ªõi\n                    </div>\n                    <a href=\"${login_url}\" class=\"cta-button\">üîê ƒêƒÉng Nh·∫≠p & ƒê·ªïi M·∫≠t Kh·∫©u</a>\n                </div>\n\n                <div class=\"divider\"></div>\n            </div>\n\n            <div class=\"footer\">\n                <span class=\"footer-logo\">üîê</span>\n                <div class=\"footer-brand\">File Transfer System</div>\n                <div class=\"footer-tagline\">B·∫£o m·∫≠t t√†i kho·∫£n l√† ∆∞u ti√™n h√†ng ƒë·∫ßu</div>\n                <div class=\"footer-info\">\n                    ƒê√¢y l√† email t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng b·∫£o m·∫≠t.<br/>\n                    Vui l√≤ng kh√¥ng reply tr·ª±c ti·∫øp v√†o email n√†y.\n                </div>\n                <div class=\"footer-time\">\n                    üïê Th·ªùi gian g·ª≠i: <strong>${formattedDate}</strong>\n                </div>\n                <div class=\"footer-copyright\">\n                    ¬© 2025 File Transfer System. All rights reserved.<br/>\n                    B·∫£o m·∫≠t t√†i kho·∫£n c·ªßa b·∫°n l√† tr√°ch nhi·ªám c·ªßa ch√∫ng t√¥i üõ°Ô∏è<br/>\n                    <strong>Email h·ªó tr·ª£: webaptgroub@gmail.com</strong>\n                </div>\n            </div>\n        </div>\n    </div>\n</body>\n</html>`;\n\n// B∆Ø·ªöC 6: Return d·ªØ li·ªáu ƒë·ªÉ g·ª≠i email\nreturn {\n  email: email,\n  username: username,\n  temp_password: temp_password,\n  timestamp: formattedDate,\n  expires_at: formattedExpiresAt,\n  expires_in_minutes: expires_in_minutes,\n  greeting: greeting,\n  greetingIcon: greetingIcon,\n  login_url: login_url,\n  subject: `üîê [QUAN TR·ªåNG] M·∫≠t Kh·∫©u T·∫°m Th·ªùi Cho ${username} - C√≥ Hi·ªáu L·ª±c ${expires_in_minutes} Ph√∫t`,\n  htmlBody: htmlBody,\n  plainText: `${greeting} ${username}!\n\nY√äU C·∫¶U ƒê·∫∂T L·∫†I M·∫¨T KH·∫®U\n\n‚ö†Ô∏è TH√îNG B√ÅO B·∫¢O M·∫¨T:\nN·∫øu b·∫°n KH√îNG y√™u c·∫ßu ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u, vui l√≤ng B·ªé QUA email n√†y v√† li√™n h·ªá h·ªó tr·ª£ ngay!\n\nüîë M·∫¨T KH·∫®U T·∫†M TH·ªúI:\n${temp_password}\n\nüìã TH√îNG TIN:\n- Email: ${email}\n- Username: ${username}\n- Th·ªùi gian t·∫°o: ${formattedDate}\n- H·∫øt h·∫°n l√∫c: ${formattedExpiresAt}\n- Hi·ªáu l·ª±c: ${expires_in_minutes} ph√∫t\n\nüìñ H∆Ø·ªöNG D·∫™N:\n1. Truy c·∫≠p trang ƒëƒÉng nh·∫≠p\n2. Nh·∫≠p m·∫≠t kh·∫©u t·∫°m: ${temp_password}\n3. H·ªá th·ªëng s·∫Ω y√™u c·∫ßu ƒë·ªïi m·∫≠t kh·∫©u m·ªõi\n4. Ho√†n t·∫•t v√† s·ª≠ d·ª•ng m·∫≠t kh·∫©u m·ªõi\n\nüõ°Ô∏è L∆ØU √ù B·∫¢O M·∫¨T:\n- M·∫≠t kh·∫©u t·∫°m ch·ªâ c√≥ hi·ªáu l·ª±c ${expires_in_minutes} ph√∫t\n- B·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p b·∫±ng m·∫≠t kh·∫©u C≈® ho·∫∑c m·∫≠t kh·∫©u T·∫†M\n- Sau khi ƒëƒÉng nh·∫≠p b·∫±ng m·∫≠t kh·∫©u t·∫°m, B·∫ÆT BU·ªòC ƒë·ªïi m·∫≠t kh·∫©u m·ªõi\n- KH√îNG chia s·∫ª m·∫≠t kh·∫©u t·∫°m cho b·∫•t k·ª≥ ai\n\nüöÄ ƒêƒÇNG NH·∫¨P NGAY:\n${login_url}\n\n¬© 2025 File Transfer System\nEmail h·ªó tr·ª£: webaptgroub@gmail.com`\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        208,
        176
      ],
      "id": "forgot-password-code-001",
      "name": "Code - Forgot Password Email"
    },
    {
      "parameters": {
        "sendTo": "={{ $json.email }}",
        "subject": "={{ $json.subject }}",
        "message": "={{ $json.htmlBody }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        416,
        176
      ],
      "id": "forgot-password-gmail-001",
      "name": "Send Forgot Password Email",
      "webhookId": "forgot-password-gmail-webhook-001",
      "credentials": {
        "gmailOAuth2": {
          "id": "XjjVI9QLgTOoHcve",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n  \"success\": true,\n  \"message\": \"Email m·∫≠t kh·∫©u t·∫°m ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng\",\n  \"email\": \"{{ $json.email }}\",\n  \"expires_in_minutes\": {{ $json.expires_in_minutes }},\n  \"timestamp\": \"{{ now().toISO() }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        624,
        176
      ],
      "id": "forgot-password-respond-001",
      "name": "Respond - Success"
    }
  ],
  "connections": {
    "Webhook - Forgot Password": {
      "main": [
        [
          {
            "node": "Code - Forgot Password Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code - Forgot Password Email": {
      "main": [
        [
          {
            "node": "Send Forgot Password Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Forgot Password Email": {
      "main": [
        [
          {
            "node": "Respond - Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "forgot-password-workflow-v1"
  }
}
